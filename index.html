<!DOCTYPE html>
<html lang="vi" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gi·ªõi Thi·ªáu B·∫£n Th√¢n</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="theme-switch-wrapper">
        <label class="theme-switch" for="checkbox">
            <input type="checkbox" id="checkbox" />
            <div class="slider round">
                <i class="fas fa-sun"></i>
                <i class="fas fa-moon"></i>
            </div>
        </label>
    </div>
    <div class="language-switch-wrapper">
        <button class="language-btn" id="languageBtn">
            <i class="fas fa-globe"></i>
            <span class="current-lang">VI</span>
        </button>
        <div class="language-dropdown">
            <button class="lang-option" data-lang="vi">
                <img src="https://flagcdn.com/w20/vn.png" alt="Vietnamese">
                <span>Ti·∫øng Vi·ªát</span>
            </button>
            <button class="lang-option" data-lang="en">
                <img src="https://flagcdn.com/w20/gb.png" alt="English">
                <span>English</span>
            </button>
            <button class="lang-option" data-lang="fr">
                <img src="https://flagcdn.com/w20/fr.png" alt="Fran√ßais">
                <span>Fran√ßais</span>
            </button>
        </div>
    </div>
    <div class="container">
        <div class="profile-card">
            <div class="profile-header">
                <div class="avatar-container">
                    <div class="avatar">
                        <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Cun&backgroundColor=b6e3f4" alt="Avatar" id="profileAvatarImg">
                    </div>
                    <div class="avatar-decoration"></div>
                </div>
                <h1 data-translate="greeting" id="greetingText">Xin ch√†o! üëã</h1>
                <h2 data-translate="intro">M√¨nh l√† <span class="highlight">C√∫n</span></h2>
                <p class="nickname" data-translate="nickname">(Hay c√≤n ƒë∆∞·ª£c g·ªçi l√† C√∫n cute üòä)</p>
            </div>

            <div class="profile-content">
                <div class="about-me">
                    <h3 data-translate="about-title">V·ªÅ m√¨nh ‚ú®</h3>
                    <p data-translate="about-content">M√¨nh l√† m·ªôt ng∆∞·ªùi y√™u th√≠ch c√¥ng ngh·ªá v√† s√°ng t·∫°o. M√¨nh th√≠ch kh√°m ph√° nh·ªØng ƒëi·ªÅu m·ªõi m·∫ª, ƒë·ªçc s√°ch v√† nghe nh·∫°c. M√¨nh lu√¥n c·ªë g·∫Øng s·ªëng t√≠ch c·ª±c v√† lan t·ªèa nƒÉng l∆∞·ª£ng t·ªët ƒë·∫øn m·ªçi ng∆∞·ªùi xung quanh.</p>
                </div>

                <div class="slogan">
                    <p data-translate="slogan" id="sloganTyping">"H√£y s·ªëng nh∆∞ m·ªôt b√¥ng hoa, t·ªèa h∆∞∆°ng th∆°m ng√°t cho ƒë·ªùi üå∏"</p>
                </div>

                <div class="social-links">
                    <h3 data-translate="connect">K·∫øt n·ªëi v·ªõi m√¨nh nh√©! üíï</h3>
                    <div class="social-icons">
                        <a href="#" class="social-icon" title="Facebook" data-social="facebook" target="_blank">
                            <i class="fab fa-facebook"></i>
                        </a>
                        <a href="#" class="social-icon" title="Instagram" data-social="instagram" target="_blank">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="javascript:void(0);" class="social-icon phone-icon" title="S·ªë ƒëi·ªán tho·∫°i" id="showPhoneBtn">
                            <i class="fas fa-phone"></i>
                        </a>
                        <a href="#" class="social-icon" title="TikTok" data-social="tiktok" target="_blank">
                            <i class="fab fa-tiktok"></i>
                        </a>
                        <a href="#" class="social-icon locket-icon" title="Locket" data-social="locket" target="_blank">
                            <i class="fas fa-heart"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Cute Password Dialog -->
    <div class="cute-dialog-overlay" id="cuteDialogOverlay" style="display:none;">
        <div class="cute-dialog">
            <span class="dialog-decor decor-heart">üíñ</span>
            <span class="dialog-decor decor-star">‚ú®</span>
            <span class="dialog-decor decor-flower">üå∏</span>
            <button class="close-dialog" id="closeDialogBtn">√ó</button>
            <h2>üîí Nh·∫≠p m·∫≠t kh·∫©u ƒë·ªÉ xem s·ªë ƒëi·ªán tho·∫°i</h2>
            <input type="password" id="phonePassInput" placeholder="Nh·∫≠p m·∫≠t kh·∫©u si√™u cute..." />
            <button class="submit-pass-btn" id="submitPassBtn">X√°c nh·∫≠n üíñ</button>
            <div class="dialog-message" id="dialogMessage"></div>
        </div>
    </div>
    <!-- Cute Phone Reveal -->
    <div class="cute-dialog-overlay" id="phoneRevealOverlay" style="display:none;">
        <div class="cute-dialog phone-reveal">
            <span class="dialog-decor decor-heart">üíñ</span>
            <span class="dialog-decor decor-star">‚ú®</span>
            <span class="dialog-decor decor-flower">üå∏</span>
            <button class="close-dialog" id="closePhoneDialogBtn">√ó</button>
            <h2>üéâ S·ªë ƒëi·ªán tho·∫°i c·ªßa C√∫n n√®!</h2>
            <div class="phone-number" id="phoneNumber">0983161786</div>
            <div class="phone-anim">üíåüì±üíñ</div>
        </div>
    </div>
    <!-- Cute Flower Button -->
    <button class="flower-fab" id="flowerFabBtn" title="ƒêƒÉng nh·∫≠p si√™u cute">üå∏</button>
    <!-- Cute Login Dialog -->
    <div class="cute-dialog-overlay" id="loginDialogOverlay" style="display:none;">
        <div class="cute-dialog login-dialog">
            <span class="dialog-decor decor-heart">üíñ</span>
            <span class="dialog-decor decor-star">‚ú®</span>
            <span class="dialog-decor decor-flower">üå∏</span>
            <button class="close-dialog" id="closeLoginDialogBtn">√ó</button>
            <h2>üå∏ ƒêƒÉng nh·∫≠p si√™u cute</h2>
            <input type="text" id="loginUserInput" placeholder="T√™n ƒëƒÉng nh·∫≠p..." autocomplete="username" />
            <input type="password" id="loginPassInput" placeholder="M·∫≠t kh·∫©u..." autocomplete="current-password" />
            <button class="submit-pass-btn" id="submitLoginBtn">ƒêƒÉng nh·∫≠p üíñ</button>
            <div class="dialog-message" id="loginDialogMessage"></div>
        </div>
    </div>
    <!-- Cute Login Success Dialog -->
    <div class="cute-dialog-overlay" id="loginSuccessOverlay" style="display:none;">
        <div class="cute-dialog login-success">
            <span class="dialog-decor decor-heart">üíñ</span>
            <span class="dialog-decor decor-star">‚ú®</span>
            <span class="dialog-decor decor-flower">üå∏</span>
            <button class="close-dialog" id="closeLoginSuccessBtn">√ó</button>
            <h2>ƒêƒÉng nh·∫≠p th√†nh c√¥ng!</h2>
            <div class="phone-anim">üå∏ü•≥üíñ</div>
        </div>
    </div>
    <script>
        // Profile data cache
        let profileData = {};

        // Load profile data from API
        async function loadProfileData() {
            try {
                const response = await fetch('http://127.0.0.1:8000/profile');
                const data = await response.json();
                if (data.profile) {
                    profileData = data; // Cache the whole data object
                    document.querySelector('[data-translate="intro"]').innerHTML = `M√¨nh l√† <span class="highlight">${data.profile.name || 'C√∫n'}</span>`;
                    document.querySelector('[data-translate="nickname"]').textContent = `(Hay c√≤n ƒë∆∞·ª£c g·ªçi l√† ${data.profile.nickname || 'C√∫n cute üòä'})`;
                    document.querySelector('[data-translate="about-content"]').textContent = data.profile.about || 'M√¨nh l√† m·ªôt ng∆∞·ªùi y√™u th√≠ch c√¥ng ngh·ªá v√† s√°ng t·∫°o...';
                    document.querySelector('[data-translate="slogan"]').textContent = data.profile.slogan || '"H√£y s·ªëng nh∆∞ m·ªôt b√¥ng hoa..."';

                    const avatarImg = document.getElementById('profileAvatarImg');
                    if (data.profile.avatar_base64) {
                        avatarImg.src = data.profile.avatar_base64;
                    } else {
                        avatarImg.src = 'https://api.dicebear.com/7.x/avataaars/svg?seed=Cun&backgroundColor=b6e3f4';
                    }

                    // Set social links
                    const socialLinks = {
                        facebook: data.profile.facebookLink,
                        instagram: data.profile.instagramLink,
                        tiktok: data.profile.tiktokLink,
                        locket: data.profile.locketLink
                    };

                    document.querySelectorAll('.social-icon[data-social]').forEach(icon => {
                        const socialName = icon.getAttribute('data-social');
                        if (socialName === 'phone') {
                            // X·ª≠ l√Ω ri√™ng cho phone
                            icon.removeAttribute('href');
                            icon.style.opacity = data.profile.phone ? '1' : '0.5';
                            icon.title = data.profile.phone ? `S·ªë ƒëi·ªán tho·∫°i: ${data.profile.phone}` : 'Ch∆∞a c√≥ s·ªë ƒëi·ªán tho·∫°i';
                            icon.onclick = function(e) {
                                e.preventDefault();
                                if (data.profile.phone) {
                                    // Hi·ªán dialog s·ªë ƒëi·ªán tho·∫°i
                                    document.getElementById('phoneNumber').textContent = data.profile.phone;
                                    document.getElementById('phoneRevealOverlay').style.display = 'flex';
                                    setTimeout(() => {
                                        document.getElementById('phoneNumber').classList.add('reveal-anim');
                                    }, 100);
                                } else {
                                    alert('Ch∆∞a c√≥ s·ªë ƒëi·ªán tho·∫°i!');
                                }
                            };
                        } else {
                            if (socialLinks[socialName]) {
                                icon.href = socialLinks[socialName];
                                icon.style.opacity = '1';
                                icon.title = socialName.charAt(0).toUpperCase() + socialName.slice(1);
                            } else {
                                icon.href = 'javascript:void(0);';
                                icon.style.opacity = '0.5';
                                icon.title = `${socialName.charAt(0).toUpperCase() + socialName.slice(1)} (Ch∆∞a c√≥ link)`;
                            }
                            icon.onclick = null;
                        }
                    });

                } else {
                    console.error("Profile data not found in API response");
                    // Set defaults if profile is empty
                    document.querySelector('[data-translate="intro"]').innerHTML = `M√¨nh l√† <span class="highlight">C√∫n</span>`;
                    document.querySelector('[data-translate="nickname"]').textContent = `(Hay c√≤n ƒë∆∞·ª£c g·ªçi l√† C√∫n cute üòä)`;
                    document.querySelector('[data-translate="about-content"]').textContent = 'M√¨nh l√† m·ªôt ng∆∞·ªùi y√™u th√≠ch c√¥ng ngh·ªá v√† s√°ng t·∫°o. M√¨nh th√≠ch kh√°m ph√° nh·ªØng ƒëi·ªÅu m·ªõi m·∫ª, ƒë·ªçc s√°ch v√† nghe nh·∫°c. M√¨nh lu√¥n c·ªë g·∫Øng s·ªëng t√≠ch c·ª±c v√† lan t·ªèa nƒÉng l∆∞·ª£ng t·ªët ƒë·∫øn m·ªçi ng∆∞·ªùi xung quanh.';
                    document.querySelector('[data-translate="slogan"]').textContent = '"H√£y s·ªëng nh∆∞ m·ªôt b√¥ng hoa, t·ªèa h∆∞∆°ng th∆°m ng√°t cho ƒë·ªùi üå∏"';
                    document.querySelectorAll('.social-icon[data-social]').forEach(icon => {
                        icon.href = 'javascript:void(0);';
                        icon.style.opacity = '0.5';
                        const socialName = icon.getAttribute('data-social');
                        icon.title = `${socialName.charAt(0).toUpperCase() + socialName.slice(1)} (Ch∆∞a c√≥ link)`;
                    });
                }
            } catch (error) {
                console.error('Error loading profile:', error);
                // Handle error: display default text or a message to the user
                document.querySelector('[data-translate="intro"]').innerHTML = `M√¨nh l√† <span class="highlight">C√∫n</span>`;
                document.querySelector('[data-translate="nickname"]').textContent = `(Hay c√≤n ƒë∆∞·ª£c g·ªçi l√† C√∫n cute üòä)`;
                document.querySelector('[data-translate="about-content"]').textContent = 'L·ªói khi t·∫£i th√¥ng tin c√° nh√¢n. Vui l√≤ng th·ª≠ l·∫°i sau.';
                document.querySelector('[data-translate="slogan"]').textContent = '---';
                 document.querySelectorAll('.social-icon[data-social]').forEach(icon => {
                        icon.href = 'javascript:void(0);';
                        icon.style.opacity = '0.5';
                        const socialName = icon.getAttribute('data-social');
                        icon.title = `${socialName.charAt(0).toUpperCase() + socialName.slice(1)} (L·ªói t·∫£i)`;
                    });
            }
        }

        // Load data when page loads
        window.onload = loadProfileData;

        // Theme switcher
        const toggleSwitch = document.querySelector('.theme-switch input[type="checkbox"]');
        const currentTheme = localStorage.getItem('theme');

        if (currentTheme) {
            document.documentElement.setAttribute('data-theme', currentTheme);
            if (currentTheme === 'dark') {
                toggleSwitch.checked = true;
            }
        }

        function switchTheme(e) {
            if (e.target.checked) {
                document.documentElement.setAttribute('data-theme', 'dark');
                localStorage.setItem('theme', 'dark');
            } else {
                document.documentElement.setAttribute('data-theme', 'light');
                localStorage.setItem('theme', 'light');
            }    
        }

        toggleSwitch.addEventListener('change', switchTheme, false);

        // Language switcher
        const translations = {
            vi: {
                greeting: "Xin ch√†o! üëã",
                intro: "M√¨nh l√† C√∫n",
                nickname: "(Hay c√≤n ƒë∆∞·ª£c g·ªçi l√† C√∫n cute üòä)",
                "about-title": "V·ªÅ m√¨nh ‚ú®",
                "about-content": "M√¨nh l√† m·ªôt ng∆∞·ªùi y√™u th√≠ch c√¥ng ngh·ªá v√† s√°ng t·∫°o. M√¨nh th√≠ch kh√°m ph√° nh·ªØng ƒëi·ªÅu m·ªõi m·∫ª, ƒë·ªçc s√°ch v√† nghe nh·∫°c. M√¨nh lu√¥n c·ªë g·∫Øng s·ªëng t√≠ch c·ª±c v√† lan t·ªèa nƒÉng l∆∞·ª£ng t·ªët ƒë·∫øn m·ªçi ng∆∞·ªùi xung quanh.",
                slogan: "\"H√£y s·ªëng nh∆∞ m·ªôt b√¥ng hoa, t·ªèa h∆∞∆°ng th∆°m ng√°t cho ƒë·ªùi üå∏\"",
                connect: "K·∫øt n·ªëi v·ªõi m√¨nh nh√©! üíï"
            },
            en: {
                greeting: "Hello! üëã",
                intro: "I'm Cun",
                nickname: "(Also known as Cute Cun üòä)",
                "about-title": "About Me ‚ú®",
                "about-content": "I'm a tech enthusiast and creative person. I love exploring new things, reading books, and listening to music. I always try to live positively and spread good energy to everyone around me.",
                slogan: "\"Live like a flower, spreading sweet fragrance to life üå∏\"",
                connect: "Connect with me! üíï"
            },
            fr: {
                greeting: "Bonjour! üëã",
                intro: "Je suis Cun",
                nickname: "(Aussi connue comme Mignonne Cun üòä)",
                "about-title": "√Ä propos de moi ‚ú®",
                "about-content": "Je suis passionn√©e de technologie et cr√©ative. J'aime explorer de nouvelles choses, lire des livres et √©couter de la musique. J'essaie toujours de vivre positivement et de r√©pandre une bonne √©nergie autour de moi.",
                slogan: "\"Vivre comme une fleur, r√©pandant un doux parfum dans la vie üå∏\"",
                connect: "Connectez-vous avec moi! üíï"
            }
        };

        const languageBtn = document.getElementById('languageBtn');
        const currentLang = document.querySelector('.current-lang');
        const langOptions = document.querySelectorAll('.lang-option');
        const dropdown = document.querySelector('.language-dropdown');

        // Toggle dropdown
        languageBtn.addEventListener('click', () => {
            dropdown.classList.toggle('show');
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', (e) => {
            if (!languageBtn.contains(e.target)) {
                dropdown.classList.remove('show');
            }
        });

        // Change language
        langOptions.forEach(option => {
            option.addEventListener('click', () => {
                const lang = option.dataset.lang;
                currentLang.textContent = lang.toUpperCase();
                
                document.querySelectorAll('[data-translate]').forEach(element => {
                    const key = element.dataset.translate;
                    if (translations[lang][key]) {
                        element.textContent = translations[lang][key];
                    }
                });

                dropdown.classList.remove('show');
                localStorage.setItem('language', lang);

                // Automation: Ch√†o t·ª± ƒë·ªông theo th·ªùi gian trong ng√†y
                function getGreeting() {
                    const hour = new Date().getHours();
                    if (hour >= 5 && hour < 12) return 'Ch√∫c bu·ªïi s√°ng vui v·∫ª! ‚òÄÔ∏è';
                    if (hour >= 12 && hour < 18) return 'Ch√∫c bu·ªïi chi·ªÅu ng·ªçt ng√†o! üç¨';
                    return 'Ch√∫c bu·ªïi t·ªëi ·∫•m √°p! üåô';
                }
                function getGreetingEN() {
                    const hour = new Date().getHours();
                    if (hour >= 5 && hour < 12) return 'Good morning! ‚òÄÔ∏è';
                    if (hour >= 12 && hour < 18) return 'Have a sweet afternoon! üç¨';
                    return 'Have a cozy evening! üåô';
                }
                function getGreetingFR() {
                    const hour = new Date().getHours();
                    if (hour >= 5 && hour < 12) return 'Bonne matin√©e! ‚òÄÔ∏è';
                    if (hour >= 12 && hour < 18) return 'Bel apr√®s-midi! üç¨';
                    return 'Bonne soir√©e! üåô';
                }
                function setAutoGreeting(lang) {
                    const greetingText = document.getElementById('greetingText');
                    if (lang === 'vi') greetingText.textContent = getGreeting();
                    else if (lang === 'en') greetingText.textContent = getGreetingEN();
                    else if (lang === 'fr') greetingText.textContent = getGreetingFR();
                }
                // G·ªçi khi load v√† khi ƒë·ªïi ng√¥n ng·ªØ
                setTimeout(() => {
                    setAutoGreeting(lang);
                }, 100);

                // Load profile data after language change
                loadProfileData();
            });
        });

        // Load saved language
        const savedLang = localStorage.getItem('language') || 'vi';
        currentLang.textContent = savedLang.toUpperCase();
        langOptions.forEach(option => {
            if (option.dataset.lang === savedLang) {
                option.click();
            }
        });

        // Cute phone dialog logic
        const showPhoneBtn = document.getElementById('showPhoneBtn');
        const cuteDialogOverlay = document.getElementById('cuteDialogOverlay');
        const closeDialogBtn = document.getElementById('closeDialogBtn');
        const submitPassBtn = document.getElementById('submitPassBtn');
        const phonePassInput = document.getElementById('phonePassInput');
        const dialogMessage = document.getElementById('dialogMessage');
        const phoneRevealOverlay = document.getElementById('phoneRevealOverlay');
        const closePhoneDialogBtn = document.getElementById('closePhoneDialogBtn');
        const phoneNumber = document.getElementById('phoneNumber');

        showPhoneBtn.addEventListener('click', async (e) => {
            e.preventDefault();
            // L·∫•y s·ªë ƒëi·ªán tho·∫°i m·ªõi nh·∫•t t·ª´ API m·ªói l·∫ßn m·ªü dialog
            try {
                const response = await fetch('http://127.0.0.1:8000/profile');
                const data = await response.json();
                if (data.profile && data.profile.phone) {
                    document.getElementById('phoneNumber').textContent = data.profile.phone;
                } else {
                    document.getElementById('phoneNumber').textContent = 'Ch∆∞a c√≥ s·ªë ƒëi·ªán tho·∫°i!';
                }
            } catch {
                document.getElementById('phoneNumber').textContent = 'L·ªói t·∫£i s·ªë ƒëi·ªán tho·∫°i!';
            }
            cuteDialogOverlay.style.display = 'flex';
            phonePassInput.value = '';
            dialogMessage.textContent = '';
            phonePassInput.focus();
        });
        closeDialogBtn.addEventListener('click', () => {
            cuteDialogOverlay.style.display = 'none';
        });
        submitPassBtn.addEventListener('click', () => {
            if (phonePassInput.value === 'yeudangnhat') {
                cuteDialogOverlay.style.display = 'none';
                setTimeout(() => {
                    phoneRevealOverlay.style.display = 'flex';
                    phoneNumber.classList.add('reveal-anim');
                }, 300);
            } else {
                dialogMessage.textContent = 'Sai m·∫≠t kh·∫©u r·ªìi üò¢ Th·ª≠ l·∫°i nh√©!';
                dialogMessage.style.color = '#e91e63';
                phonePassInput.value = '';
                phonePassInput.focus();
            }
        });
        phonePassInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') submitPassBtn.click();
        });
        closePhoneDialogBtn.addEventListener('click', () => {
            phoneRevealOverlay.style.display = 'none';
            phoneNumber.classList.remove('reveal-anim');
        });

        // Cute login dialog logic
        const flowerFabBtn = document.getElementById('flowerFabBtn');
        const loginDialogOverlay = document.getElementById('loginDialogOverlay');
        const closeLoginDialogBtn = document.getElementById('closeLoginDialogBtn');
        const submitLoginBtn = document.getElementById('submitLoginBtn');
        const loginUserInput = document.getElementById('loginUserInput');
        const loginPassInput = document.getElementById('loginPassInput');
        const loginDialogMessage = document.getElementById('loginDialogMessage');
        const loginSuccessOverlay = document.getElementById('loginSuccessOverlay');
        const closeLoginSuccessBtn = document.getElementById('closeLoginSuccessBtn');

        flowerFabBtn.addEventListener('click', () => {
            loginDialogOverlay.style.display = 'flex';
            loginUserInput.value = '';
            loginPassInput.value = '';
            loginDialogMessage.textContent = '';
            loginUserInput.focus();
        });
        closeLoginDialogBtn.addEventListener('click', () => {
            loginDialogOverlay.style.display = 'none';
        });
        submitLoginBtn.addEventListener('click', () => {
            if (loginUserInput.value === 'yeudangnhat' && loginPassInput.value === 'yeudangnhat') {
                loginDialogOverlay.style.display = 'none';
                setTimeout(() => {
                    window.location.href = 'edit.html';
                }, 300);
            } else {
                loginDialogMessage.textContent = 'Sai t√†i kho·∫£n ho·∫∑c m·∫≠t kh·∫©u r·ªìi üò¢';
                loginDialogMessage.style.color = '#e91e63';
                loginPassInput.value = '';
                loginPassInput.focus();
            }
        });
        loginUserInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') loginPassInput.focus();
        });
        loginPassInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') submitLoginBtn.click();
        });
        closeLoginSuccessBtn.addEventListener('click', () => {
            loginSuccessOverlay.style.display = 'none';
        });
    </script>
</body>
</html> 