<!DOCTYPE html>
<html lang="vi" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ch·ªânh s·ª≠a th√¥ng tin c√° nh√¢n</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <div class="profile-card">
            <button class="logout-btn" id="logoutBtn" title="ƒêƒÉng xu·∫•t">‚éã ƒêƒÉng xu·∫•t</button>
            <div class="profile-header">
                <div class="avatar-container">
                    <div class="avatar">
                        <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Cun&backgroundColor=b6e3f4" alt="Avatar" id="avatarImg">
                    </div>
                    <div class="avatar-decoration"></div>
                </div>
                <input type="text" id="editName" class="edit-input main-name" value="C√∫n" />
                <input type="text" id="editNickname" class="edit-input nickname" value="C√∫n cute üòä" />
            </div>
            <div class="profile-content">
                <div class="about-me">
                    <h3>V·ªÅ m√¨nh ‚ú®</h3>
                    <textarea id="editAbout" class="edit-textarea">M√¨nh l√† m·ªôt ng∆∞·ªùi y√™u th√≠ch c√¥ng ngh·ªá v√† s√°ng t·∫°o. M√¨nh th√≠ch kh√°m ph√° nh·ªØng ƒëi·ªÅu m·ªõi m·∫ª, ƒë·ªçc s√°ch v√† nghe nh·∫°c. M√¨nh lu√¥n c·ªë g·∫Øng s·ªëng t√≠ch c·ª±c v√† lan t·ªèa nƒÉng l∆∞·ª£ng t·ªët ƒë·∫øn m·ªçi ng∆∞·ªùi xung quanh.</textarea>
                </div>
                <div class="slogan">
                    <textarea id="editSlogan" class="edit-textarea">"H√£y s·ªëng nh∆∞ m·ªôt b√¥ng hoa, t·ªèa h∆∞∆°ng th∆°m ng√°t cho ƒë·ªùi üå∏"</textarea>
                </div>
                <div class="social-links">
                    <h3>K·∫øt n·ªëi v·ªõi m√¨nh nh√©! üíï</h3>
                    <div class="social-icons">
                        <a href="#" class="social-icon"><i class="fab fa-facebook"></i></a>
                        <a href="#" class="social-icon"><i class="fab fa-instagram"></i></a>
                        <a href="#" class="social-icon phone-icon"><i class="fas fa-phone"></i></a>
                        <a href="#" class="social-icon"><i class="fab fa-tiktok"></i></a>
                        <a href="#" class="social-icon locket-icon"><i class="fas fa-heart"></i></a>
                    </div>
                </div>
                <button class="submit-pass-btn save-btn" id="saveProfileBtn">L∆∞u th√¥ng tin</button>
                <div class="dialog-message" id="saveMessage"></div>
                
                <div class="version-history">
                    <h3>L·ªãch s·ª≠ c√°c phi√™n b·∫£n üìö</h3>
                    <div id="versionList" class="version-list"></div>
                </div>
            </div>
        </div>
    </div>
    <script>
        // Load data from API
        window.onload = async function() {
            try {
                const response = await fetch('http://localhost:8080/api.php');
                const data = await response.json();
                if (data.profile) {
                    document.getElementById('editName').value = data.profile.name;
                    document.getElementById('editNickname').value = data.profile.nickname;
                    document.getElementById('editAbout').value = data.profile.about;
                    document.getElementById('editSlogan').value = data.profile.slogan;
                    
                    // Hi·ªÉn th·ªã th√¥ng tin phi√™n b·∫£n hi·ªán t·∫°i
                    if (data.version) {
                        const versionList = document.getElementById('versionList');
                        const versionItem = document.createElement('div');
                        versionItem.className = 'version-item current';
                        versionItem.innerHTML = `
                            <div class="version-info">
                                <span class="version-file">${data.version.file}</span>
                                <span class="version-time">${data.version.timestamp}</span>
                            </div>
                        `;
                        versionList.appendChild(versionItem);
                    }
                }
            } catch (error) {
                console.error('Error loading profile:', error);
            }
        };

        // Save data to API
        document.getElementById('saveProfileBtn').onclick = async function() {
            const profileData = {
                profile: {
                    name: document.getElementById('editName').value,
                    nickname: document.getElementById('editNickname').value,
                    about: document.getElementById('editAbout').value,
                    slogan: document.getElementById('editSlogan').value
                }
            };

            try {
                const response = await fetch('http://localhost:8080/api.php', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(profileData)
                });
                const result = await response.json();
                
                if (result.success) {
                    document.getElementById('saveMessage').textContent = 'ƒê√£ l∆∞u th√¥ng tin th√†nh c√¥ng! ‚ú®';
                    setTimeout(() => {
                        document.getElementById('saveMessage').textContent = '';
                    }, 3000);
                } else {
                    document.getElementById('saveMessage').textContent = 'C√≥ l·ªói x·∫£y ra khi l∆∞u th√¥ng tin üò¢';
                }
            } catch (error) {
                console.error('Error saving profile:', error);
                document.getElementById('saveMessage').textContent = 'C√≥ l·ªói x·∫£y ra khi l∆∞u th√¥ng tin üò¢';
            }
        };

        // ƒêƒÉng xu·∫•t
        document.getElementById('logoutBtn').onclick = function() {
            window.location.href = 'index.html';
        };
    </script>
    <style>
        .version-history {
            margin-top: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }
        
        .version-history h3 {
            margin: 0 0 10px 0;
            color: #e91e63;
        }
        
        .version-list {
            max-height: 200px;
            overflow-y: auto;
        }
        
        .version-item {
            padding: 8px;
            margin: 5px 0;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .version-item.current {
            background: rgba(233, 30, 99, 0.1);
            border-left: 3px solid #e91e63;
        }
        
        .version-item.new {
            animation: highlight 2s ease-out;
        }
        
        .version-info {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        
        .version-file {
            font-weight: bold;
            color: #e91e63;
        }
        
        .version-time {
            font-size: 0.9em;
            color: #666;
        }
        
        @keyframes highlight {
            0% { background: rgba(233, 30, 99, 0.2); }
            100% { background: rgba(255, 255, 255, 0.05); }
        }
    </style>
</body>
</html> 